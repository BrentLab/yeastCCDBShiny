# test_that({
#   base64_response_chunks <- list(
#     "WAoAAAADAAQEAAADBQAAAAAFVVRGLTgAAAMTAAAACgAAABAAAAABAAQACQAAAGBodHRwOi8vMTI3LjAuMC4xOjgwMDEvYXBpL3Byb21vdGVyc2V0c2lnL3JhbmtyZXNwb25zZS8/cHJvbW90ZXJzZXRzaWdfaWQ9ODc4MyZleHByZXNzaW9uX2lkPTQ1NjMAAAANAAAAAQAAAMgAAAMTAAAADAAAABAAAAABAAQACQAAAB1XZWQsIDI5IE1heSAyMDI0IDE5OjI1OjMxIEdNVAAAABAAAAABAAQACQAAAAd1dmljb3JuAAAAEAAAAAEABAAJAAAAEGFwcGxpY2F0aW9uL2d6aXAAAAAQAAAAAQAEAAkAAAAvYXR0YWNobWVudDsgZmlsZW5hbWU9InJhbmtyZXNwb25zZV84NzgzLnRhci5neiIAAAAQAAAAAQAEAAkAAAAnQWNjZXB0LCBBY2NlcHQtTGFuZ3VhZ2UsIENvb2tpZSwgb3JpZ2luAAAAEAAAAAEABAAJAAAAEkdFVCwgSEVBRCwgT1BUSU9OUwAAABAAAAABAAQACQAAAARERU5ZAAAAEAAAAAEABAAJAAAAAzc3NgAAABAAAAABAAQACQAAAAJlbgAAABAAAAABAAQACQAAAAdub3NuaWZmAAAAEAAAAAEABAAJAAAAC3NhbWUtb3JpZ2luAAAAEAAAAAEABAAJAAAAC3NhbWUtb3JpZ2luAAAEAgAAAAEABAAJAAAABW5hbWVzAAAAEAAAAAwABAAJAAAABGRhdGUABAAJAAAABnNlcnZlcgAEAAkAAAAMY29udGVudC10eXBlAAQACQAAABNjb250ZW50LWRpc3Bvc2l0aW9uAAQACQAAAAR2YXJ5AAQACQAAAAVhbGxvdwAEAAkAAAAPeC1mcmFtZS1vcHRpb25zAAQACQAAAA5jb250ZW50LWxlbmd0aAAEAAkAAAAQY29udGVudC1sYW5ndWFnZQAEAAk",
#     "AAAWeC1jb250ZW50LXR5cGUtb3B0aW9ucwAEAAkAAAAPcmVmZXJyZXItcG9saWN5AAQACQAAABpjcm9zcy1vcmlnaW4tb3BlbmVyLXBvbGljeQAABAIAAAABAAQACQAAAAVjbGFzcwAAABAAAAACAAQACQAAAAtpbnNlbnNpdGl2ZQAEAAkAAAAEbGlzdAAAAP4AAAATAAAAAgAAAhMAAAADAAAADQAAAAEAAAEtAAAAEAAAAAEABAAJAAAACEhUVFAvMS4xAAADEwAAAAoAAAAQAAAAAQAEAAkAAAAdV2VkLCAyOSBNYXkgMjAyNCAxOToyNTozMSBHTVQAAAAQAAAAAQAEAAkAAAAHdXZpY29ybgAAABAAAAABAAQACQAAABh0ZXh0L2h0bWw7IGNoYXJzZXQ9dXRmLTgAAAAQAAAAAQAEAAkAAABLL2FwaS9wcm9tb3RlcnNldHNpZy9yYW5rcmVzcG9uc2UvP3Byb21vdGVyc2V0c2lnX2lkPTg3ODMmZXhwcmVzc2lvbl9pZD00NTYzAAAAEAAAAAEABAAJAAAAF0FjY2VwdC1MYW5ndWFnZSwgb3JpZ2luAAAAEAAAAAEABAAJAAAAAmVuAAAAEAAAAAEABAAJAAAAB25vc25pZmYAAAAQAAAAAQAEAAkAAAALc2FtZS1vcmlnaW4AAAAQAAAAAQAEAAkAAAALc2FtZS1vcmlnaW4AAAAQAAAAAQAEAAkAAAAHY2h1bmtlZAAABAIAAAH/AAAAEAAAAAoABAAJAAAABGRhdGUABAAJAAAABnNlcnZlcgAEAAkAAAAMY29udGVudC10eXBlAAQACQAAAAhsb2NhdGlvbgAEAAkAAAAEdmFyeQAEAAkAAAAQY29udGVudC1sYW5ndWFnZQAEAAkAAAAWeC1jb250ZW50LXR5cGUtb3B0aW9ucwAEAAkAAAAPcmVmZXJyZXItcG9saWN5AAQACQAAABpjcm9zcy1vcmlnaW4",
#     "b3BlbmVyLXBvbGljeQAEAAkAAAARdHJhbnNmZXItZW5jb2RpbmcAAAQCAAAC/wAAABAAAAACAAQACQAAAAtpbnNlbnNpdGl2ZQAEAAkAAAAEbGlzdAAAAP4AAAQCAAAB/wAAABAAAAADAAQACQAAAAZzdGF0dXMABAAJAAAAB3ZlcnNpb24ABAAJAAAAB2hlYWRlcnMAAAD+AAACEwAAAAMAAAANAAAAAQAAAMgAAAAQAAAAAQAEAAkAAAAISFRUUC8xLjEAAAMTAAAADAAAABAAAAABAAQACQAAAB1XZWQsIDI5IE1heSAyMDI0IDE5OjI1OjMxIEdNVAAAABAAAAABAAQACQAAAAd1dmljb3JuAAAAEAAAAAEABAAJAAAAEGFwcGxpY2F0aW9uL2d6aXAAAAAQAAAAAQAEAAkAAAAvYXR0YWNobWVudDsgZmlsZW5hbWU9InJhbmtyZXNwb25zZV84NzgzLnRhci5neiIAAAAQAAAAAQAEAAkAAAAnQWNjZXB0LCBBY2NlcHQtTGFuZ3VhZ2UsIENvb2tpZSwgb3JpZ2luAAAAEAAAAAEABAAJAAAAEkdFVCwgSEVBRCwgT1BUSU9OUwAAABAAAAABAAQACQAAAARERU5ZAAAAEAAAAAEABAAJAAAAAzc3NgAAABAAAAABAAQACQAAAAJlbgAAABAAAAABAAQACQAAAAdub3NuaWZmAAAAEAAAAAEABAAJAAAAC3NhbWUtb3JpZ2luAAAAEAAAAAEABAAJAAAAC3NhbWUtb3JpZ2luAAAEAgAAAf8AAAAQAAAADAAEAAkAAAAEZGF0ZQAEAAkAAAAGc2VydmVyAAQACQAAAAxjb250ZW50LXR5cGUABAAJAAAAE2NvbnRlbnQtZGlzcG9zaXRpb24ABAAJAAAABHZhcnkABAAJAAAABWFsbG93AAQACQAAAA94LWZyYW1lLW9wdGlvbnMABAAJAAAADmNvbnRlbnQtbGVuZ3R",
#     "AAQACQAAABBjb250ZW50LWxhbmd1YWdlAAQACQAAABZ4LWNvbnRlbnQtdHlwZS1vcHRpb25zAAQACQAAAA9yZWZlcnJlci1wb2xpY3kABAAJAAAAGmNyb3NzLW9yaWdpbi1vcGVuZXItcG9saWN5AAAEAgAAAv8AAAAQAAAAAgAEAAkAAAALaW5zZW5zaXRpdmUABAAJAAAABGxpc3QAAAD+AAAEAgAAAf8AAAAQAAAAAwAEAAkAAAAGc3RhdHVzAAQACQAAAAd2ZXJzaW9uAAQACQAAAAdoZWFkZXJzAAAA/gAAAxMAAAAHAAAACgAAAAAAAAAKAAAAAAAAAAoAAAAAAAAACgAAAAAAAAMOAAAAAAAABAIAAAL/AAAAEAAAAAIABAAJAAAAB1BPU0lYY3QABAAJAAAABlBPU0lYdAAAAP4AAAAKAAAAAAAAAAoAAAAAAAAEAgAAAf8AAAAQAAAABwAEAAkAAAAGZG9tYWluAAQACQAAAARmbGFnAAQACQAAAARwYXRoAAQACQAAAAZzZWN1cmUABAAJAAAACmV4cGlyYXRpb24ABAAJAAAABG5hbWUABAAJAAAABXZhbHVlAAAEAgAAAAEABAAJAAAACXJvdy5uYW1lcwAAAA0AAAAAAAAEAgAAAv8AAAAQAAAAAQAEAAkAAAAKZGF0YS5mcmFtZQAAAP4AAAMQAAAAAQAEAAkAAAAkL3RtcC9SdG1wMTBYdFI5L2ZpbGUyMzQ1MzViNjg4MjUudGFyAAAEAgAAAv8AAAAQAAAAAQAEAAkAAAAEcGF0aAAAAP4AAAMOAAAAAUHZleBKwAAAAAAEAgAAAv8AAAAQAAAAAgAEAAkAAAAHUE9TSVhjdAAEAAkAAAAGUE9TSVh0AAAEAgAAAAEABAAJAAAABXR6b25lAAAAEAAAAAEABAAJAAAAA0dNVAAAAP4AAAIOAAAABj+tE1EVnEl3PxDG96C17Y0/Ir5IpYs/ZD8qWHDaXa8",
#     "P9StlqagElo/1K9sabWmQAAABAIAAAH/AAAAEAAAAAYABAAJAAAACHJlZGlyZWN0AAQACQAAAApuYW1lbG9va3VwAAQACQAAAAdjb25uZWN0AAQACQAAAAtwcmV0cmFuc2ZlcgAEAAkAAAANc3RhcnR0cmFuc2ZlcgAEAAkAAAAFdG90YWwAAAD+AAADEwAAAAcAAAAQAAAAAQAEAAkAAAADR0VUAAAAEAAAAAEABAAJAAAAX2h0dHA6Ly8xMjcuMC4wLjE6ODAwMS9hcGkvcHJvbW90ZXJzZXRzaWcvcmFua3Jlc3BvbnNlP3Byb21vdGVyc2V0c2lnX2lkPTg3ODMmZXhwcmVzc2lvbl9pZD00NTYzAAACEAAAAAMABAAJAAAAMGFwcGxpY2F0aW9uL2pzb24sIHRleHQveG1sLCBhcHBsaWNhdGlvbi94bWwsICovKgAEAAkAAAAQYXBwbGljYXRpb24vanNvbgAEAAkAAAAuVG9rZW4gNDhhM2EyNzMzZGI1NGEyNGFlYjhlOWYxNTAwOGRiNzY3MGU3YTI3ZgAABAIAAAH/AAAAEAAAAAMABAAJAAAABkFjY2VwdAAEAAkAAAAMQ29udGVudC1UeXBlAAQACQAAAA1BdXRob3JpemF0aW9uAAAA/gAAAP4AAAITAAAAAgAAABAAAAABAAQACQAAACZsaWJjdXJsLzcuODEuMCByLWN1cmwvNS4yLjEgaHR0ci8xLjQuNwAAAAoAAAABAAAAAQAABAIAAAH/AAAAEAAAAAIABAAJAAAACXVzZXJhZ2VudAAEAAkAAAAHaHR0cGdldAAAAP4AAAD+AAADEwAAAAIAAAAQAAAAAQAEAAkAAAAkL3RtcC9SdG1wMTBYdFI5L2ZpbGUyMzQ1MzViNjg4MjUudGFyAAAA/gAABAIAAAH/AAAAEAAAAAIABAAJAAAABHBhdGgABAAJAAAABGZpbGUAAAQCAAAC/wAAABAAAAACAAQ",
#     "CQAAAAp3cml0ZV9kaXNrAAQACQAAAA53cml0ZV9mdW5jdGlvbgAAAP4AAAQCAAAB/wAAABAAAAAHAAQACQAAAAZtZXRob2QABAAJAAAAA3VybAAEAAkAAAAHaGVhZGVycwAEAAkAAAAGZmllbGRzAAQACQAAAAdvcHRpb25zAAQACQAAAAphdXRoX3Rva2VuAAQACQAAAAZvdXRwdXQAAAQCAAAC/wAAABAAAAABAAQACQAAAAdyZXF1ZXN0AAAA/gAAAxYAAAATAAAABwAAAP4AAAD+AAAA/gAAAP4AAAD+AAAA/gAAAP4AAAD+AAAEAgAAAv8AAAAQAAAAAQAEAAkAAAALY3VybF9oYW5kbGUAAAD+AAAEAgAAAf8AAAAQAAAACgAEAAkAAAADdXJsAAQACQAAAAtzdGF0dXNfY29kZQAEAAkAAAAHaGVhZGVycwAEAAkAAAALYWxsX2hlYWRlcnMABAAJAAAAB2Nvb2tpZXMABAAJAAAAB2NvbnRlbnQABAAJAAAABGRhdGUABAAJAAAABXRpbWVzAAQACQAAAAdyZXF1ZXN0AAQACQAAAAZoYW5kbGUAAAQCAAAC/wAAABAAAAABAAQACQAAAAhyZXNwb25zZQAAAP4="
#   )
#
#   response_base64 <- paste(base64_response_chunks, collapse = "")
#
#   # Decode the concatenated base64 string into a raw vector
#   response_raw <- base64enc::base64decode(response_base64)
#
#   # Deserialize the raw vector back into the original response object
#   response <- unserialize(response_raw)
#
#   tar_base64 = "H4sICCuBV2YC/3Jlc3VsdHMudGFyANPT19N3CEis8EhNTEktYqAJMIAAXLSBgbEJgg0SNzQwMjRiUKhgoAMoLS5JLAJazzAygZGFQm5JZm6qraG5oTkw4M2NDfXMLMwNzMzNuRhGwbAH+nSwA5SpzSH53cjU0BCZhud5QxMzI1OgIhNTE1D+NzExYVAwpWf+T85ILE7Nxa2OkPwQBXqj5f9o+T9a/o9YUFCUn5tfkloUb2FuYRyfWlFQlFpcnJmfF29iamasl1xcppdeRY38b2ZigrP8NzczQiv/zQ1MDBgUDOiZ/0do+S/fzcGh3RiexvSfYEpgqAk+nXfbQGDP6+iWhPv96w2DwtkXr8yN8P30W1boq6JrKNOUo0+rysrKvlTs/WdRuzvm+uuXG99+v126vyZnObffjoiPP+p+d+7++7fm3rfa29ftI6WF6mLzXv99/PVtbfT56Zdvvy2u7pn+/Xdttc6+U176c26tScmKFAoxXNym65P15KCb0DRlF73Ma333A75xHDkVqtzqcVj0OvflU/9Zwlye54l2n8jJXPDC5Vjk7ZmWxld1BLnFizXVuZRWtf5lqNjUu/+axpFXOTcnKtyQteNKDdsU7bF4f+Pzcwr6bcklRvpO2rLXD7LJ/DDZkilbP/fUklVl6o3rMnj/LTM8sjjQalHRxMVsfzjvZJhKOy2p/snSF5TGrSx2/crErClLMrUmnWXTFV/anMgntyj+egazUHNm6SKv5ycW5V1dc6Cim8W2x0mpdSNXkNeOs9MC/++4IBP1giGcXee1w8JDlh3NzJMO2i+2W3L6EOuB9IKNyrevCFvaOh7Sfcjdq8mXppDEcnRXbZtIQuQR0Q3TC/TKjuxI+/J61dT4jCC1R0ckzgjv+r6EZxHXVsM0XqbZR1/WX/h4xKst9oGk3tRNmbwz+j9yBv74sOf7J2kGhv//mRn+ltvwPmMeLfFGwSgYBaNgFIyCUTAKRsEoGAWjYBSMglEwCkbBKBgFo2AUjIJRMAqGNwAA/TH27AAoAAA="
#
#   # Decode the tar file content and write it to a temporary file
#   tar_content <- base64enc::base64decode(tar_base64)
#   tar_file <- tempfile(fileext = ".tar")
#   writeBin(tar_content, tar_file)
#
# })
